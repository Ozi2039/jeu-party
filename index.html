<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<title>V√©rit√© Party</title>
<style>
  html, body {
    margin:0;
    padding:0;
    height:100%;
    width:100%;
    font-family:sans-serif;
    background:#0d1117;
    color:white;
    display:flex;
    align-items:center;
    justify-content:center;
    overflow:hidden;
    -webkit-user-select: none;
    user-select: none;
  }

  .phone {
    width: 320px;
    height: 600px;
    border-radius: 36px;
    background: url('Zu1MKPS9.jpg') no-repeat center/cover;
    display: flex;
    flex-direction: column;
    justify-content: flex-end;
    padding: 20px;
    box-shadow: 0 0 40px rgba(0,0,0,0.5);
    position: relative;
    overflow: hidden;
    transition: all 0.3s ease;
  }

  .phone::before {
    content: "";
    position: absolute;
    top:0;
    left:0;
    width:100%;
    height:100%;
    background: rgba(0,0,0,0.5);
    z-index: 0;
    border-radius: 36px;
  }

  .phone > * { position: relative; z-index: 1; }

  .fullscreen {
    width: 100vw !important;
    height: calc(var(--vh, 1vh) * 100) !important;
    border-radius: 0 !important;
    box-shadow: none !important;
    padding: 0 !important;
    margin: 0 !important;
  }

  .screen {display:none; width:100%; flex-direction:column; align-items:center; justify-content:center;}
  .active {display:flex;}

  button {
    padding:12px 20px; 
    margin:5px; 
    border:none; 
    border-radius:8px; 
    cursor:pointer; 
    background:#00d4ff; 
    font-weight:bold; 
    font-size:16px;
    color:#000;
  }

  input, textarea {
    padding:8px; 
    margin:5px; 
    border-radius:6px; 
    border:none; 
    width:100%;
    background: rgba(255,255,255,0.8);
    color: #000;
  }

  .players-list div {margin:3px 0;}

  .call-box {text-align:center; width: 100%;}
  .caller {font-size:20px; margin-bottom:20px;}
  .slide-container {
    position: relative;
    width: calc(100% - 20px);
    height: 60px;
    background: rgba(0,0,0,0.6);
    border-radius: 30px;
    overflow: hidden;
    margin: 0 10px;
  }
  .slide-btn {
    position: absolute;
    top:5px;
    left:5px;
    width:50px;
    height:50px;
    background:#00ff88;
    border-radius:50%;
    cursor:grab;
    display:flex;
    align-items:center;
    justify-content:center;
    font-weight:bold;
    user-select: none;
    touch-action: none;
  }
  .question {
    font-size:20px;
    max-width:280px;
    padding:20px;
    background: rgba(0,0,0,0.7);
    border-radius:12px;
    margin:20px;
    text-align:center;
  }

  .slide-text {text-align:center; margin-top:10px; font-size:14px; color:#ccc;}

  @media (max-width: 480px) {
    .phone { 
      width: 100vw; 
      height: calc(var(--vh, 1vh) * 100); 
      border-radius:0; 
      box-shadow: none;
    }
    .phone::before { border-radius:0; }
    .question { max-width: calc(100% - 40px); }
    .slide-container {
      width: calc(100% - 20px);
      margin: 0 10px;
    }
  }
</style>
</head>
<body>

<div class="phone" id="phone">
  <div id="menu" class="screen active">
    <h1>üéâ V√©rit√© Party üéâ</h1>
    <button onclick="toggleFullScreen()">üì± Plein √©cran</button>
    <h3>Liste des joueurs</h3>
    <div id="playersList"></div>
    <input type="text" id="playerInput" placeholder="Nom du joueur">
    <button onclick="addPlayer()">Ajouter joueur</button>
    
    <h3>Questions (JSON)</h3>
    <textarea id="questionsInput" rows="5" cols="30"></textarea><br>
    <button onclick="saveQuestions()">Sauvegarder Questions</button>
    
    <br><br>
    <button id="playBtn">Jouer</button>
  </div>

  <div id="callScreen" class="screen">
    <div class="call-box">
      <div class="caller" id="callerName"></div>
      <div class="slide-container" id="slider">
        <div class="slide-btn" id="slideBtn">üìû</div>
      </div>
      <div class="slide-text">‚Üí Glisse pour d√©crocher</div>
    </div>
  </div>

  <div id="questionScreen" class="screen">
    <div class="question" id="questionText"></div>
    <div>
      <button onclick="continueGame()">Continuer</button>
      <button onclick="backToMenu()">Menu</button>
    </div>
  </div>
</div>

<script>
let players = [];
let questions = ["Quelle est ta plus grande honte ?", "Ton plus gros mensonge ?", "Ton secret le plus g√™nant ?"];
document.getElementById("questionsInput").value = JSON.stringify(questions, null, 2);

function addPlayer(){
  const name = document.getElementById("playerInput").value.trim();
  if(name){ players.push(name); document.getElementById("playerInput").value = ""; renderPlayers(); }
}
function renderPlayers(){
  const list = document.getElementById("playersList");
  list.innerHTML = players.map((p,i)=>`<div>${p} <button onclick="removePlayer(${i})">‚ùå</button></div>`).join("");
}
function removePlayer(i){ players.splice(i,1); renderPlayers(); }
function saveQuestions(){
  try { questions = JSON.parse(document.getElementById("questionsInput").value); alert("Questions mises √† jour !"); } 
  catch(e){ alert("Erreur JSON invalide !"); }
}

const menu = document.getElementById("menu");
const callScreen = document.getElementById("callScreen");
const questionScreen = document.getElementById("questionScreen");
const callerName = document.getElementById("callerName");
const questionText = document.getElementById("questionText");
const phone = document.getElementById("phone");

document.getElementById("playBtn").addEventListener("click", startGame);

function toggleFullScreen() {
  if (!document.fullscreenElement) {
    const docEl = document.documentElement;
    if (docEl.requestFullscreen) {
      docEl.requestFullscreen().catch(err => console.error('Fullscreen error:', err));
    } else if (docEl.webkitRequestFullscreen) {
      docEl.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT).catch(err => console.error('Fullscreen error:', err));
    }
    phone.classList.add('fullscreen');
  } else {
    if (document.exitFullscreen) {
      document.exitFullscreen().catch(err => console.error('Exit fullscreen error:', err));
    } else if (document.webkitExitFullscreen) {
      document.webkitExitFullscreen();
    }
    phone.classList.remove('fullscreen');
  }
}

function startGame(){
  if(players.length===0){ alert("Ajoute au moins un joueur !"); return; }
  if(questions.length===0){ alert("Ajoute au moins une question !"); return; }

  const player = players[Math.floor(Math.random()*players.length)];
  const question = questions[Math.floor(Math.random()*questions.length)];

  callerName.textContent = `üìû Yo ${player}, Jackson t'appelle !`;
  // Ajout du message "R√©ponds √† la question ou prends un shot"
  questionText.textContent = question + "\n\nüëâ R√©ponds √† la question ou prends un shot üçª";

  menu.classList.remove("active");
  callScreen.classList.add("active");

  document.querySelectorAll('#menu input, #menu textarea, #menu button').forEach(el => el.style.display='none');

  initSlider();
}

function continueGame(){ callScreen.classList.remove("active"); questionScreen.classList.remove("active"); startGame(); }
function backToMenu(){ 
  questionScreen.classList.remove("active"); callScreen.classList.remove("active"); menu.classList.add("active");
  document.querySelectorAll('#menu input, #menu textarea, #menu button').forEach(el => el.style.display='block');
}

function initSlider(){
  const btn = document.getElementById("slideBtn");
  const slider = document.getElementById("slider");
  let isDragging=false, startX=0;
  btn.style.left="5px";

  const maxSlideDistance = slider.offsetWidth - btn.offsetWidth - 10;

  btn.onmousedown=e=>{ isDragging=true; startX=e.clientX; };
  document.onmouseup=e=>{ 
    if(isDragging){ 
      isDragging=false; 
      if(parseInt(btn.style.left) > maxSlideDistance * 0.9){ 
        callScreen.classList.remove("active"); 
        questionScreen.classList.add("active"); 
      } else {
        btn.style.left="5px"; 
      }
    } 
  };
  document.onmousemove=e=>{ 
    if(isDragging){ 
      let dx=e.clientX-startX; 
      btn.style.left=Math.min(Math.max(5,5+dx),maxSlideDistance)+"px"; 
    } 
  };

  btn.ontouchstart=e=>{ 
    isDragging=true; 
    startX=e.touches[0].clientX; 
    e.preventDefault();
  };
  btn.ontouchend=e=>{ 
    if(isDragging){ 
      isDragging=false; 
      if(parseInt(btn.style.left) > maxSlideDistance * 0.9){ 
        callScreen.classList.remove("active"); 
        questionScreen.classList.add("active"); 
      } else {
        btn.style.left="5px"; 
      } 
    } 
  };
  btn.ontouchmove=e=>{ 
    if(isDragging){ 
      let dx=e.touches[0].clientX-startX; 
      btn.style.left=Math.min(Math.max(5,5+dx),maxSlideDistance)+"px"; 
      e.preventDefault(); 
    } 
  };
}

function setVh() {
  let vh = window.innerHeight * 0.01;
  document.documentElement.style.setProperty('--vh', `${vh}px`);
}
window.addEventListener('resize', setVh);
window.addEventListener('load', setVh);

function isAppleDevice() {
  return /iPhone|iPad|iPod|Macintosh/.test(navigator.userAgent);
}
window.addEventListener("load", () => {
  if (isAppleDevice()) {
    alert("‚ö†Ô∏è Sur iPhone/iPad, le mode plein √©cran doit √™tre activ√© manuellement.");
  }
});
</script>
</body>
</html>
